<!-- Copyright (C) 2014 Erik Ringsmuth <erik.ringsmuth@gmail.com> -->
<link rel="import" href="/bower_components/polymer/polymer.html">

<polymer-element name="search-result-item" attributes="searchResultItem" on-click="{{open}}" on-keydown="{{keydownEventHandler}}">
  <template>
    <style>
      :host {
        display: block;
        padding: 5px;
      }
      :host:hover {
        background-color: #ebebeb;
      }
      span {
        display: inline-block;
      }
      .name {
        width: 26%;
        color: #777;
      }
    </style>
    <span class="name">{{searchResultItem.name}}</span>
    <span>
      <span class="method">{{searchResultItem.method}}</span>
      <span class="url">{{searchResultItem.url}}</span>
    </span>
  </template>
  <script>
    Polymer('search-result-item', {
      ready: function() {
        window.addEventListener('navigate', function(event) {
          if (event.detail.tabIndex === this.tabIndex) {
            this.focus();
          }
        }.bind(this), true);
      },

      open: function open() {
        window.dispatchEvent(new CustomEvent('new-xhr-panel', {detail: this.searchResultItem}));
      },

      keydownEventHandler: function keydownEventHandler(event) {
        // Update on enter
        if(event.keyCode === 13) {
          this.open();
        }

        // Fire navigate event on up or down arrow
        if (event.keyCode === 40) {
          window.dispatchEvent(new CustomEvent('navigate', {detail: {tabIndex: this.tabIndex + 1}}));
        }
        if (event.keyCode === 38) {
          window.dispatchEvent(new CustomEvent('navigate', {detail: {tabIndex: this.tabIndex - 1}}));
        }
      }
    });
  </script>
</polymer-element>
