<!-- Copyright (C) 2014 Erik Ringsmuth <erik.ringsmuth@gmail.com> -->
<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/elements/new-xhr-panel-button.html">
<link rel="import" href="/elements/new-code-panel-button.html">

<polymer-element name="api-sequence-menu" attributes="contentPlaceholder apiSequence">
  <template>
    <style>
      :host {
        display: block;
        white-space: nowrap;
        overflow: hidden;
        position: relative;
      }
      ul {
        list-style-type: none;
        margin-left: -40px;
        border-bottom: 1px dotted #ddd;
      }
      li {
        padding: 10px 5px;
        border-top: 1px dotted #ddd;
      }
      li:hover {
        background-color: #ebebeb;
      }
      new-xhr-panel-button button,
      new-code-panel-button button {
        width: 49%;
      }
    </style>
    <h2>API Sequence</h2>
    <ul>
      <template repeat="{{ item, index in apiSequence }}">
        <li data-index="{{index}}" on-click="{{scrollToPanel}}">{{item.panelName}}<button type="button" class="close" data-index="{{index}}" on-click="{{removePanel}}" aria-hidden="true">&times;</button></li>
      </template>
    </ul>
    <new-xhr-panel-button apisequence="{{apiSequence}}" contentplaceholder="{{contentPlaceholder}}"></new-xhr-panel-button>
    <new-code-panel-button  apisequence="{{apiSequence}}" contentplaceholder="{{contentPlaceholder}}"></new-code-panel-button>
  </template>
  <script>
    Polymer('api-sequence-menu', {
      parentOffsetTop: 0,

      ready: function() {
        var self = this;
        window.addEventListener('scroll', function() {
          self.style.top = Math.max(0, window.pageYOffset - self.offsetParent.offsetTop) + 'px';
        });
      },

      scrollToPanel: function scrollToPanel(event) {
        $('html,body').animate({
          scrollTop: this.apiSequence[event.target.dataset.index].offsetTop + this.offsetParent.offsetTop - 10
        }, 200, 'easeOutQuint');
      },

      removePanel: function removePanel(event) {
        this.apiSequence[event.target.dataset.index].close();
        event.stopPropagation();
      }
    });
  </script>
</polymer-element>
